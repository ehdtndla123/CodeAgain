# Planner Web



## ModelMapper

> http://modelmapper.org/
> ê°ì²´ì˜ í”„ë¡œí¼í‹°ë¥¼ ë‹¤ë¥¸ ê°ì²´ì˜ í”„ë¡œí¼í‹°ë¡œ ë§µí•‘í•´ì£¼ëŠ” ìœ í‹¸ë¦¬í‹°

`ModelMapper` ë€ ì„œë¡œ ë‹¤ë¥¸ object ê°„ì˜ í•„ë“œ ê°’ì„ ìë™ìœ¼ë¡œ mapping í•´ì£¼ëŠ” library

### ì–¸ì œ ì‚¬ìš©í• ê¹Œ?

ì˜ˆë¥¼ë“¤ì–´ Springboot + jpa ë¡œ ê°œë°œí•  ê²½ìš° Entity ì™€ view layerì—ì„œ ì‚¬ìš©ë  data objectê°€ êµ¬ë¶„ëœë‹¤. ë”°ë¼ì„œ Entityì˜ ê°’ì„ view layerì— ì „ë‹¬í•  ê²½ìš° data object ë¡œ ìƒˆë¡œ ë³€í™˜í•´ì£¼ëŠ” ì‘ì—…ì„ í•´ì•¼í•œë‹¤. ì¼ë°˜ì ìœ¼ë¡œ getter/setter ë˜ëŠ” Builder íŒ¨í„´ì„ í†µí•˜ì—¬ í•´ë‹¹ ì‘ì—…ì„ í•  ê²½ìš° í•„ë“œê°€ ë§ì„ ìˆ˜ë¡ ì½”ë“œê°€ ê¸¸ì–´ì§€ê³  ë°˜ë³µì ì¸ ì‘ì—…ëŸ‰ì´ ëŠ˜ì–´ë‚œë‹¤.

```java
        TestEntity testEntity = testRepository.findById("test");

        TestDto testDto = new TestDto();
        testDto.setEmail(testEntity.getEmail());
        testDto.setGender(testEntity.getGender());
        testDto.setId(testEntity.getId());
        
        // ...
        
```

**ë°˜ë³µì ì¸ object ê°„ ë³€í™˜ì„ ê°„ë‹¨í•˜ê²Œ ì¤„ì´ê³  ì‹¶ì„ ë•Œ `ModelMapper` ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤!**

### ì‚¬ìš©ë²•

#### ì˜ì¡´ì„± ì£¼ì….

**maven**

```xml
<dependency>
    <groupId>org.modelmapper</groupId>
    <artifactId>modelmapper</artifactId>
    <version>2.3.8</version>
</dependency>
```

**gradle**

```java
implementation group: 'org.modelmapper', name: 'modelmapper', version: '2.3.8'
```

#### Spring Bean ë“±ë¡

ë§¤ë²ˆ `ModelMapper` ë¥¼ ìƒì„±í•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆì§€ë§Œ, ë°˜ë³µì ìœ¼ë¡œ ì—¬ëŸ¬ ë¡œì§ì—ì„œ ì‚¬ìš©ë¨ìœ¼ë¡œ @Bean ìœ¼ë¡œ ë“±ë¡í•˜ì—¬ ì‚¬ìš©í•˜ì.

```java
@Configuration
public class AppConfig {

    @Bean
    public ModelMapper modelMapper(){
        return new ModelMapper();
    }
}
```

#### ì‚¬ìš© ë°©ë²•

data ì˜ ì›ë³¸ì´ ë˜ëŠ” source ì™€ ê¸°ì¡´ ê°ì²´ì— ë§¤í•í•  ê²½ìš° í•´ë‹¹ ê°ì²´ë¥¼, ìƒˆë¡œìš´ ê°ì²´ë¥¼ ìƒì„±í•  ê²½ìš° ìƒì„±í•  ê°ì²´ì˜ class ë¥¼ ì „ë‹¬í•˜ë©´ ëœë‹¤.

```java
TestEntity testEntity = testRepository.findById("test");
 
TestDto testDto = modelMapper.map(testEntity, TestDto.class);

// TestDto testDto = new TestDto();
// testDto.setEmail(testEntity.getEmail());
// testDto.setGender(testEntity.getGender());
// testDto.setId(testEntity.getId());
```

**ì¶”ê°€ì ìœ¼ë¡œ íŠ¹ì • í•„ë“œ skip, Nullì¸ í•„ë“œ, sourceì™€ destination ê°ì²´ ê°„ì˜ í•„ë“œê°€ ë‹¤ë¥¼ ê²½ìš° ë“± ë‹¤ì–‘í•œ ìƒí™©ì— ëŒ€í•œ handling ë°©ë²•ì´ ìˆë‹¤. í•´ë‹¹ ë‚´ìš©ì€ http://modelmapper.org/ ì—ì„œ ì§ì ‘ í™•ì¸ í•´ë³´ë©´ì„œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.**





# REST API ì œëŒ€ë¡œ ì•Œê³  ì‚¬ìš©í•˜ê¸°

> ### ëª©ì°¨
>
> 1. REST APIì˜ íƒ„ìƒ
> 2. REST êµ¬ì„±
> 3. REST ì˜ íŠ¹ì§•
> 4. REST API ë””ìì¸ ê°€ì´ë“œ
> 5. HTTP ì‘ë‹µ ìƒíƒœ ì½”ë“œ

![ê·¸ë¦¼1.png](https://image.toast.com/aaaadh/alpha/2016/techblog/uADF8uB9BC1.png)

> ì–´ëŠ ë‚  ëœ¬ê¸ˆì—†ì´ ëŒ€í•™êµ ì¹œêµ¬ì—ê²Œ ì „í™”ê°€ ì™”ìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë”ë‹ˆ â€˜ì•¼, REST APIê°€ ì •í™•íˆ ë­ ì–´ë–¤ ê±°ì•¼? í•˜ëŠ” ì§ˆë¬¸ì— ê°€ìŠ´ì— ë¹„ìˆ˜ê°€ ë‚ ì•„ì™€ ê½‚íŒ ë“¯í•œ ëŠë‚Œì„ ë°›ì•˜ìŠµë‹ˆë‹¤. ë©°ì¹  ì „ ì¹´í†¡ìœ¼ë¡œ ìš”ì¦˜ ë³´í†µ ì›¹ì„œë¹„ìŠ¤ë“¤ì€ â€˜REST APIí˜•íƒœë¡œ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•œë‹¤â€™ê³  ì•„ëŠ” ì²™ì„ ì¡°ê¸ˆ í–ˆë˜ ê¸°ì–µì´ ë¨¸ë¦¿ì†ì„ ë¹ ë¥´ê²Œ ìŠ¤ì³ ì§€ë‚˜ê°”ê³  ê·¸ ìˆœê°„ ëŒ€ì¶© ì–¼ë²„ë¬´ë¦¬ë©° â€˜ì•„, ê·¸ê±° RESTí•˜ê²Œ í´ë¼ì´ì–¸íŠ¸ë‘ ì„œë²„ê°„ì— ë°ì´í„°ë¥¼ ì£¼ê³  ë°›ëŠ” ë°©ì‹â€™ì„ ë§í•œë‹¤ë©° ì–¼ë ëš±ë•… ë§ˆë¬´ë¦¬ ì§€ì—ˆë˜ ê¸°ì–µì´ ë‚©ë‹ˆë‹¤. ì‹¤ì œë¡œ REST APIì˜ ì„œë¹„ìŠ¤ë¥¼ ì§ì ‘ ê°œë°œë„ í•´ë³´ê³  ì‚¬ìš©ë„ í•´ë´¤ëŠ”ë°ë„ ë§‰ìƒ ì„¤ëª…ì„ í•˜ìë‹ˆ ì–´ë ¤ì›€ì„ ê²ªì—ˆë˜ ì ì´ ìˆìœ¼ì…¨ì„ í…ë°ìš”. ê·¸ë˜ì„œ ì´ë²ˆì— REST APIì— ëŒ€í•´ ì •ë¦¬í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. ê¸°ë³¸ì ì¸ REST APIì— ëŒ€í•œ ë‚´ìš© ì™¸ì—ë„ REST APIë¥¼ ì„¤ê³„í•˜ì‹¤ ë•Œ ì°¸ê³ í•´ì•¼ í•  ëª‡ ê°€ì§€ TIPë“¤ì— ëŒ€í•´ ê³µìœ í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

## 1. REST APIì˜ íƒ„ìƒ

RESTëŠ” Representational State Transferë¼ëŠ” ìš©ì–´ì˜ ì•½ìë¡œì„œ 2000ë…„ë„ì— ë¡œì´ í•„ë”© (Roy Fielding)ì˜ ë°•ì‚¬í•™ìœ„ ë…¼ë¬¸ì—ì„œ ìµœì´ˆë¡œ ì†Œê°œë˜ì—ˆìŠµë‹ˆë‹¤. ë¡œì´ í•„ë”©ì€ HTTPì˜ ì£¼ìš” ì €ì ì¤‘ í•œ ì‚¬ëŒìœ¼ë¡œ ê·¸ ë‹¹ì‹œ ì›¹(HTTP) ì„¤ê³„ì˜ ìš°ìˆ˜ì„±ì— ë¹„í•´ ì œëŒ€ë¡œ ì‚¬ìš©ë˜ì–´ì§€ì§€ ëª»í•˜ëŠ” ëª¨ìŠµì— ì•ˆíƒ€ê¹Œì›Œí•˜ë©° ì›¹ì˜ ì¥ì ì„ ìµœëŒ€í•œ í™œìš©í•  ìˆ˜ ìˆëŠ” ì•„í‚¤í…ì²˜ë¡œì¨ RESTë¥¼ ë°œí‘œí–ˆë‹¤ê³  í•©ë‹ˆë‹¤.

## 2. REST êµ¬ì„±

ì‰½ê²Œ ë§í•´ REST APIëŠ” ë‹¤ìŒì˜ êµ¬ì„±ìœ¼ë¡œ ì´ë£¨ì–´ì ¸ìˆìŠµë‹ˆë‹¤. ìì„¸í•œ ë‚´ìš©ì€ ë°‘ì—ì„œ ì„¤ëª…í•˜ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

- **ìì›(RESOURCE)** - URI
- **í–‰ìœ„(Verb)** - HTTP METHOD
- **í‘œí˜„(Representations)**

## 3. REST ì˜ íŠ¹ì§•

#### 1) Uniform (ìœ ë‹ˆí¼ ì¸í„°í˜ì´ìŠ¤)

Uniform InterfaceëŠ” URIë¡œ ì§€ì •í•œ ë¦¬ì†ŒìŠ¤ì— ëŒ€í•œ ì¡°ì‘ì„ í†µì¼ë˜ê³  í•œì •ì ì¸ ì¸í„°í˜ì´ìŠ¤ë¡œ ìˆ˜í–‰í•˜ëŠ” ì•„í‚¤í…ì²˜ ìŠ¤íƒ€ì¼ì„ ë§í•©ë‹ˆë‹¤.

#### 2) Stateless (ë¬´ìƒíƒœì„±)

RESTëŠ” ë¬´ìƒíƒœì„± ì„±ê²©ì„ ê°–ìŠµë‹ˆë‹¤. ë‹¤ì‹œ ë§í•´ ì‘ì—…ì„ ìœ„í•œ ìƒíƒœì •ë³´ë¥¼ ë”°ë¡œ ì €ì¥í•˜ê³  ê´€ë¦¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì„¸ì…˜ ì •ë³´ë‚˜ ì¿ í‚¤ì •ë³´ë¥¼ ë³„ë„ë¡œ ì €ì¥í•˜ê³  ê´€ë¦¬í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— API ì„œë²„ëŠ” ë“¤ì–´ì˜¤ëŠ” ìš”ì²­ë§Œì„ ë‹¨ìˆœíˆ ì²˜ë¦¬í•˜ë©´ ë©ë‹ˆë‹¤. ë•Œë¬¸ì— ì„œë¹„ìŠ¤ì˜ ììœ ë„ê°€ ë†’ì•„ì§€ê³  ì„œë²„ì—ì„œ ë¶ˆí•„ìš”í•œ ì •ë³´ë¥¼ ê´€ë¦¬í•˜ì§€ ì•ŠìŒìœ¼ë¡œì¨ êµ¬í˜„ì´ ë‹¨ìˆœí•´ì§‘ë‹ˆë‹¤.

#### 3) Cacheable (ìºì‹œ ê°€ëŠ¥)

RESTì˜ ê°€ì¥ í° íŠ¹ì§• ì¤‘ í•˜ë‚˜ëŠ” HTTPë¼ëŠ” ê¸°ì¡´ ì›¹í‘œì¤€ì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì—, ì›¹ì—ì„œ ì‚¬ìš©í•˜ëŠ” ê¸°ì¡´ ì¸í”„ë¼ë¥¼ ê·¸ëŒ€ë¡œ í™œìš©ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. ë”°ë¼ì„œ HTTPê°€ ê°€ì§„ ìºì‹± ê¸°ëŠ¥ì´ ì ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤. HTTP í”„ë¡œí† ì½œ í‘œì¤€ì—ì„œ ì‚¬ìš©í•˜ëŠ” Last-Modifiedíƒœê·¸ë‚˜ E-Tagë¥¼ ì´ìš©í•˜ë©´ ìºì‹± êµ¬í˜„ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.

#### 4) Self-descriptiveness (ìì²´ í‘œí˜„ êµ¬ì¡°)

RESTì˜ ë˜ ë‹¤ë¥¸ í° íŠ¹ì§• ì¤‘ í•˜ë‚˜ëŠ” REST API ë©”ì‹œì§€ë§Œ ë³´ê³ ë„ ì´ë¥¼ ì‰½ê²Œ ì´í•´ í•  ìˆ˜ ìˆëŠ” ìì²´ í‘œí˜„ êµ¬ì¡°ë¡œ ë˜ì–´ ìˆë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤.

#### 5) Client - Server êµ¬ì¡°

REST ì„œë²„ëŠ” API ì œê³µ, í´ë¼ì´ì–¸íŠ¸ëŠ” ì‚¬ìš©ì ì¸ì¦ì´ë‚˜ ì»¨í…ìŠ¤íŠ¸(ì„¸ì…˜, ë¡œê·¸ì¸ ì •ë³´)ë“±ì„ ì§ì ‘ ê´€ë¦¬í•˜ëŠ” êµ¬ì¡°ë¡œ ê°ê°ì˜ ì—­í• ì´ í™•ì‹¤íˆ êµ¬ë¶„ë˜ê¸° ë•Œë¬¸ì— í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ì—ì„œ ê°œë°œí•´ì•¼ í•  ë‚´ìš©ì´ ëª…í™•í•´ì§€ê³  ì„œë¡œê°„ ì˜ì¡´ì„±ì´ ì¤„ì–´ë“¤ê²Œ ë©ë‹ˆë‹¤.

#### 6) ê³„ì¸µí˜• êµ¬ì¡°

REST ì„œë²„ëŠ” ë‹¤ì¤‘ ê³„ì¸µìœ¼ë¡œ êµ¬ì„±ë  ìˆ˜ ìˆìœ¼ë©° ë³´ì•ˆ, ë¡œë“œ ë°¸ëŸ°ì‹±, ì•”í˜¸í™” ê³„ì¸µì„ ì¶”ê°€í•´ êµ¬ì¡°ìƒì˜ ìœ ì—°ì„±ì„ ë‘˜ ìˆ˜ ìˆê³  PROXY, ê²Œì´íŠ¸ì›¨ì´ ê°™ì€ ë„¤íŠ¸ì›Œí¬ ê¸°ë°˜ì˜ ì¤‘ê°„ë§¤ì²´ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤.

## 4. REST API ë””ìì¸ ê°€ì´ë“œ

REST API ì„¤ê³„ ì‹œ ê°€ì¥ ì¤‘ìš”í•œ í•­ëª©ì€ ë‹¤ìŒì˜ 2ê°€ì§€ë¡œ ìš”ì•½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**ì²« ë²ˆì§¸,** URIëŠ” ì •ë³´ì˜ ìì›ì„ í‘œí˜„í•´ì•¼ í•œë‹¤.
**ë‘ ë²ˆì§¸,** ìì›ì— ëŒ€í•œ í–‰ìœ„ëŠ” HTTP Method(GET, POST, PUT, DELETE)ë¡œ í‘œí˜„í•œë‹¤.

ë‹¤ë¥¸ ê²ƒì€ ë‹¤ ìŠì–´ë„ ìœ„ ë‚´ìš©ì€ ê¼­ ê¸°ì–µí•˜ì‹œê¸¸ ë°”ëë‹ˆë‹¤.

### 4-1. REST API ì¤‘ì‹¬ ê·œì¹™

------

#### 1) URIëŠ” ì •ë³´ì˜ ìì›ì„ í‘œí˜„í•´ì•¼ í•œë‹¤. (ë¦¬ì†ŒìŠ¤ëª…ì€ ë™ì‚¬ë³´ë‹¤ëŠ” ëª…ì‚¬ë¥¼ ì‚¬ìš©)

```
    GET /members/delete/1
```

ìœ„ì™€ ê°™ì€ ë°©ì‹ì€ RESTë¥¼ ì œëŒ€ë¡œ ì ìš©í•˜ì§€ ì•Šì€ URIì…ë‹ˆë‹¤. URIëŠ” ìì›ì„ í‘œí˜„í•˜ëŠ”ë° ì¤‘ì ì„ ë‘ì–´ì•¼ í•©ë‹ˆë‹¤. deleteì™€ ê°™ì€ í–‰ìœ„ì— ëŒ€í•œ í‘œí˜„ì´ ë“¤ì–´ê°€ì„œëŠ” ì•ˆë©ë‹ˆë‹¤.

#### 2) ìì›ì— ëŒ€í•œ í–‰ìœ„ëŠ” HTTP Method(GET, POST, PUT, DELETE ë“±)ë¡œ í‘œí˜„

ìœ„ì˜ ì˜ëª» ëœ URIë¥¼ HTTP Methodë¥¼ í†µí•´ ìˆ˜ì •í•´ ë³´ë©´

```
    DELETE /members/1
```

ìœ¼ë¡œ ìˆ˜ì •í•  ìˆ˜ ìˆê² ìŠµë‹ˆë‹¤.
íšŒì›ì •ë³´ë¥¼ ê°€ì ¸ì˜¬ ë•ŒëŠ” GET, íšŒì› ì¶”ê°€ ì‹œì˜ í–‰ìœ„ë¥¼ í‘œí˜„í•˜ê³ ì í•  ë•ŒëŠ” POST METHODë¥¼ ì‚¬ìš©í•˜ì—¬ í‘œí˜„í•©ë‹ˆë‹¤.

**íšŒì›ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ” URI**

```
    GET /members/show/1     (x)
    GET /members/1          (o)
```

**íšŒì›ì„ ì¶”ê°€í•  ë•Œ**

```
    GET /members/insert/2 (x)  - GET ë©”ì„œë“œëŠ” ë¦¬ì†ŒìŠ¤ ìƒì„±ì— ë§ì§€ ì•ŠìŠµë‹ˆë‹¤.
    POST /members/2       (o)
```

**[ì°¸ê³ ]HTTP METHODì˜ ì•Œë§ì€ ì—­í• **
POST, GET, PUT, DELETE ì´ 4ê°€ì§€ì˜ Methodë¥¼ ê°€ì§€ê³  CRUDë¥¼ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

| METHOD |                             ì—­í•                              |
| :----: | :----------------------------------------------------------: |
|  POST  |     POSTë¥¼ í†µí•´ í•´ë‹¹ URIë¥¼ ìš”ì²­í•˜ë©´ ë¦¬ì†ŒìŠ¤ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.     |
|  GET   | GETë¥¼ í†µí•´ í•´ë‹¹ ë¦¬ì†ŒìŠ¤ë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤. ë¦¬ì†ŒìŠ¤ë¥¼ ì¡°íšŒí•˜ê³  í•´ë‹¹ ë„íë¨¼íŠ¸ì— ëŒ€í•œ ìì„¸í•œ ì •ë³´ë¥¼ ê°€ì ¸ì˜¨ë‹¤. |
|  PUT   |             PUTë¥¼ í†µí•´ í•´ë‹¹ ë¦¬ì†ŒìŠ¤ë¥¼ ìˆ˜ì •í•©ë‹ˆë‹¤.             |
| DELETE |              DELETEë¥¼ í†µí•´ ë¦¬ì†ŒìŠ¤ë¥¼ ì‚­ì œí•©ë‹ˆë‹¤.              |

ë‹¤ìŒê³¼ ê°™ì€ ì‹ìœ¼ë¡œ URIëŠ” ìì›ì„ í‘œí˜„í•˜ëŠ” ë°ì— ì§‘ì¤‘í•˜ê³  í–‰ìœ„ì— ëŒ€í•œ ì •ì˜ëŠ” HTTP METHODë¥¼ í†µí•´ í•˜ëŠ” ê²ƒì´ RESTí•œ APIë¥¼ ì„¤ê³„í•˜ëŠ” ì¤‘ì‹¬ ê·œì¹™ì…ë‹ˆë‹¤.

### 4-2. URI ì„¤ê³„ ì‹œ ì£¼ì˜í•  ì 

------

#### 1) ìŠ¬ë˜ì‹œ êµ¬ë¶„ì(/)ëŠ” ê³„ì¸µ ê´€ê³„ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ë° ì‚¬ìš©

```
    http://restapi.example.com/houses/apartments
    http://restapi.example.com/animals/mammals/whales
```

#### 2) URI ë§ˆì§€ë§‰ ë¬¸ìë¡œ ìŠ¬ë˜ì‹œ(/)ë¥¼ í¬í•¨í•˜ì§€ ì•ŠëŠ”ë‹¤.

URIì— í¬í•¨ë˜ëŠ” ëª¨ë“  ê¸€ìëŠ” ë¦¬ì†ŒìŠ¤ì˜ ìœ ì¼í•œ ì‹ë³„ìë¡œ ì‚¬ìš©ë˜ì–´ì•¼ í•˜ë©° URIê°€ ë‹¤ë¥´ë‹¤ëŠ” ê²ƒì€ ë¦¬ì†ŒìŠ¤ê°€ ë‹¤ë¥´ë‹¤ëŠ” ê²ƒì´ê³ , ì—­ìœ¼ë¡œ ë¦¬ì†ŒìŠ¤ê°€ ë‹¤ë¥´ë©´ URIë„ ë‹¬ë¼ì ¸ì•¼ í•©ë‹ˆë‹¤. REST APIëŠ” ë¶„ëª…í•œ URIë¥¼ ë§Œë“¤ì–´ í†µì‹ ì„ í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì— í˜¼ë™ì„ ì£¼ì§€ ì•Šë„ë¡ URI ê²½ë¡œì˜ ë§ˆì§€ë§‰ì—ëŠ” ìŠ¬ë˜ì‹œ(/)ë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

```
    http://restapi.example.com/houses/apartments/ (X)
    http://restapi.example.com/houses/apartments  (0)
```

#### 3) í•˜ì´í”ˆ(-)ì€ URI ê°€ë…ì„±ì„ ë†’ì´ëŠ”ë° ì‚¬ìš©

URIë¥¼ ì‰½ê²Œ ì½ê³  í•´ì„í•˜ê¸° ìœ„í•´, ë¶ˆê°€í”¼í•˜ê²Œ ê¸´ URIê²½ë¡œë¥¼ ì‚¬ìš©í•˜ê²Œ ëœë‹¤ë©´ í•˜ì´í”ˆì„ ì‚¬ìš©í•´ ê°€ë…ì„±ì„ ë†’ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

#### 4) ë°‘ì¤„(_)ì€ URIì— ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.

ê¸€ê¼´ì— ë”°ë¼ ë‹¤ë¥´ê¸´ í•˜ì§€ë§Œ ë°‘ì¤„ì€ ë³´ê¸° ì–´ë µê±°ë‚˜ ë°‘ì¤„ ë•Œë¬¸ì— ë¬¸ìê°€ ê°€ë ¤ì§€ê¸°ë„ í•©ë‹ˆë‹¤. ì´ëŸ° ë¬¸ì œë¥¼ í”¼í•˜ê¸° ìœ„í•´ ë°‘ì¤„ ëŒ€ì‹  í•˜ì´í”ˆ(-)ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.(ê°€ë…ì„±)

#### 5) URI ê²½ë¡œì—ëŠ” ì†Œë¬¸ìê°€ ì í•©í•˜ë‹¤.

URI ê²½ë¡œì— ëŒ€ë¬¸ì ì‚¬ìš©ì€ í”¼í•˜ë„ë¡ í•´ì•¼ í•©ë‹ˆë‹¤. ëŒ€ì†Œë¬¸ìì— ë”°ë¼ ë‹¤ë¥¸ ë¦¬ì†ŒìŠ¤ë¡œ ì¸ì‹í•˜ê²Œ ë˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. RFC 3986(URI ë¬¸ë²• í˜•ì‹)ì€ URI ìŠ¤í‚¤ë§ˆì™€ í˜¸ìŠ¤íŠ¸ë¥¼ ì œì™¸í•˜ê³ ëŠ” ëŒ€ì†Œë¬¸ìë¥¼ êµ¬ë³„í•˜ë„ë¡ ê·œì •í•˜ê¸° ë•Œë¬¸ì´ì§€ìš”.

```
    RFC 3986 is the URI (Unified Resource Identifier) Syntax document
```

#### 6) íŒŒì¼ í™•ì¥ìëŠ” URIì— í¬í•¨ì‹œí‚¤ì§€ ì•ŠëŠ”ë‹¤.

```
    http://restapi.example.com/members/soccer/345/photo.jpg (X)
```

REST APIì—ì„œëŠ” ë©”ì‹œì§€ ë°”ë”” ë‚´ìš©ì˜ í¬ë§·ì„ ë‚˜íƒ€ë‚´ê¸° ìœ„í•œ íŒŒì¼ í™•ì¥ìë¥¼ URI ì•ˆì— í¬í•¨ì‹œí‚¤ì§€ ì•ŠìŠµë‹ˆë‹¤. Accept headerë¥¼ ì‚¬ìš©í•˜ë„ë¡ í•©ì‹œë‹¤.

```
    GET / members/soccer/345/photo HTTP/1.1 Host: restapi.example.com Accept: image/jpg
```

### 4-3. ë¦¬ì†ŒìŠ¤ ê°„ì˜ ê´€ê³„ë¥¼ í‘œí˜„í•˜ëŠ” ë°©ë²•

------

REST ë¦¬ì†ŒìŠ¤ ê°„ì—ëŠ” ì—°ê´€ ê´€ê³„ê°€ ìˆì„ ìˆ˜ ìˆê³ , ì´ëŸ° ê²½ìš° ë‹¤ìŒê³¼ ê°™ì€ í‘œí˜„ë°©ë²•ìœ¼ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤.

```
    /ë¦¬ì†ŒìŠ¤ëª…/ë¦¬ì†ŒìŠ¤ ID/ê´€ê³„ê°€ ìˆëŠ” ë‹¤ë¥¸ ë¦¬ì†ŒìŠ¤ëª…

    ex)    GET : /users/{userid}/devices (ì¼ë°˜ì ìœ¼ë¡œ ì†Œìœ  â€˜hasâ€™ì˜ ê´€ê³„ë¥¼ í‘œí˜„í•  ë•Œ)
```

ë§Œì•½ì— ê´€ê³„ëª…ì´ ë³µì¡í•˜ë‹¤ë©´ ì´ë¥¼ ì„œë¸Œ ë¦¬ì†ŒìŠ¤ì— ëª…ì‹œì ìœ¼ë¡œ í‘œí˜„í•˜ëŠ” ë°©ë²•ì´ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ì‚¬ìš©ìê°€ â€˜ì¢‹ì•„í•˜ëŠ”â€™ ë””ë°”ì´ìŠ¤ ëª©ë¡ì„ í‘œí˜„í•´ì•¼ í•  ê²½ìš° ë‹¤ìŒê³¼ ê°™ì€ í˜•íƒœë¡œ ì‚¬ìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```
    GET : /users/{userid}/likes/devices (ê´€ê³„ëª…ì´ ì• ë§¤í•˜ê±°ë‚˜ êµ¬ì²´ì  í‘œí˜„ì´ í•„ìš”í•  ë•Œ)
```

### 4-4. ìì›ì„ í‘œí˜„í•˜ëŠ” Colllectionê³¼ Document

------

Collectionê³¼ Documentì— ëŒ€í•´ ì•Œë©´ URI ì„¤ê³„ê°€ í•œ ì¸µ ë” ì‰¬ì›Œì§‘ë‹ˆë‹¤. DOCUMENTëŠ” ë‹¨ìˆœíˆ ë¬¸ì„œë¡œ ì´í•´í•´ë„ ë˜ê³ , í•œ ê°ì²´ë¼ê³  ì´í•´í•˜ì…”ë„ ë  ê²ƒ ê°™ìŠµë‹ˆë‹¤. ì»¬ë ‰ì…˜ì€ ë¬¸ì„œë“¤ì˜ ì§‘í•©, ê°ì²´ë“¤ì˜ ì§‘í•©ì´ë¼ê³  ìƒê°í•˜ì‹œë©´ ì´í•´í•˜ì‹œëŠ”ë° ì¢€ë” í¸í•˜ì‹¤ ê²ƒ ê°™ìŠµë‹ˆë‹¤. ì»¬ë ‰ì…˜ê³¼ ë„íë¨¼íŠ¸ëŠ” ëª¨ë‘ ë¦¬ì†ŒìŠ¤ë¼ê³  í‘œí˜„í•  ìˆ˜ ìˆìœ¼ë©° URIì— í‘œí˜„ë©ë‹ˆë‹¤. ì˜ˆë¥¼ ì‚´í´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

```
    http:// restapi.example.com/sports/soccer
```

ìœ„ URIë¥¼ ë³´ì‹œë©´ sportsë¼ëŠ” ì»¬ë ‰ì…˜ê³¼ soccerë¼ëŠ” ë„íë¨¼íŠ¸ë¡œ í‘œí˜„ë˜ê³  ìˆë‹¤ê³  ìƒê°í•˜ë©´ ë©ë‹ˆë‹¤. ì¢€ ë” ì˜ˆë¥¼ ë“¤ì–´ë³´ìë©´

```
    http:// restapi.example.com/sports/soccer/players/13
```

sports, players ì»¬ë ‰ì…˜ê³¼ soccer, 13(13ë²ˆì¸ ì„ ìˆ˜)ë¥¼ ì˜ë¯¸í•˜ëŠ” ë„íë¨¼íŠ¸ë¡œ URIê°€ ì´ë£¨ì–´ì§€ê²Œ ë©ë‹ˆë‹¤. ì—¬ê¸°ì„œ ì¤‘ìš”í•œ ì ì€ **ì»¬ë ‰ì…˜ì€ ë³µìˆ˜**ë¡œ ì‚¬ìš©í•˜ê³  ìˆë‹¤ëŠ” ì ì…ë‹ˆë‹¤. ì¢€ ë” ì§ê´€ì ì¸ REST APIë¥¼ ìœ„í•´ì„œëŠ” ì»¬ë ‰ì…˜ê³¼ ë„íë¨¼íŠ¸ë¥¼ ì‚¬ìš©í•  ë•Œ ë‹¨ìˆ˜ ë³µìˆ˜ë„ ì§€ì¼œì¤€ë‹¤ë©´ ì¢€ ë” ì´í•´í•˜ê¸° ì‰¬ìš´ URIë¥¼ ì„¤ê³„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## 5. HTTP ì‘ë‹µ ìƒíƒœ ì½”ë“œ

ë§ˆì§€ë§‰ìœ¼ë¡œ ì‘ë‹µ ìƒíƒœì½”ë“œë¥¼ ê°„ë‹¨íˆ ì‚´í´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤. ì˜ ì„¤ê³„ëœ REST APIëŠ” URIë§Œ ì˜ ì„¤ê³„ëœ ê²ƒì´ ì•„ë‹Œ ê·¸ ë¦¬ì†ŒìŠ¤ì— ëŒ€í•œ ì‘ë‹µì„ ì˜ ë‚´ì–´ì£¼ëŠ” ê²ƒê¹Œì§€ í¬í•¨ë˜ì–´ì•¼ í•©ë‹ˆë‹¤. ì •í™•í•œ ì‘ë‹µì˜ ìƒíƒœì½”ë“œë§Œìœ¼ë¡œë„ ë§ì€ ì •ë³´ë¥¼ ì „ë‹¬í•  ìˆ˜ê°€ ìˆê¸° ë•Œë¬¸ì— ì‘ë‹µì˜ ìƒíƒœì½”ë“œ ê°’ì„ ëª…í™•íˆ ëŒë ¤ì£¼ëŠ” ê²ƒì€ ìƒê°ë³´ë‹¤ ì¤‘ìš”í•œ ì¼ì´ ë  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. í˜¹ì‹œ 200ì´ë‚˜ 4XXê´€ë ¨ íŠ¹ì • ì½”ë“œ ì •ë„ë§Œ ì‚¬ìš©í•˜ê³  ìˆë‹¤ë©´ ì²˜ë¦¬ ìƒíƒœì— ëŒ€í•œ ì¢€ ë” ëª…í™•í•œ ìƒíƒœì½”ë“œ ê°’ì„ ì‚¬ìš©í•  ìˆ˜ ìˆê¸°ë¥¼ ê¶Œì¥í•˜ëŠ” ë°”ì…ë‹ˆë‹¤.
ìƒíƒœì½”ë“œì— ëŒ€í•´ì„œëŠ” ëª‡ ê°€ì§€ë§Œ ì •ë¦¬í•˜ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

| ìƒíƒœì½”ë“œ |                                                              |
| :------: | :----------------------------------------------------------: |
|   200    |            í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ì„ ì •ìƒì ìœ¼ë¡œ ìˆ˜í–‰í•¨             |
|   201    | í´ë¼ì´ì–¸íŠ¸ê°€ ì–´ë– í•œ ë¦¬ì†ŒìŠ¤ ìƒì„±ì„ ìš”ì²­, í•´ë‹¹ ë¦¬ì†ŒìŠ¤ê°€ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë¨(POSTë¥¼ í†µí•œ ë¦¬ì†ŒìŠ¤ ìƒì„± ì‘ì—… ì‹œ) |

| ìƒíƒœì½”ë“œ |                                                              |
| :------: | :----------------------------------------------------------: |
|   400    |    í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ì´ ë¶€ì ì ˆ í•  ê²½ìš° ì‚¬ìš©í•˜ëŠ” ì‘ë‹µ ì½”ë“œ     |
|   401    | í´ë¼ì´ì–¸íŠ¸ê°€ ì¸ì¦ë˜ì§€ ì•Šì€ ìƒíƒœì—ì„œ ë³´í˜¸ëœ ë¦¬ì†ŒìŠ¤ë¥¼ ìš”ì²­í–ˆì„ ë•Œ ì‚¬ìš©í•˜ëŠ” ì‘ë‹µ ì½”ë“œ |
|          | (ë¡œê·¸ì¸ í•˜ì§€ ì•Šì€ ìœ ì €ê°€ ë¡œê·¸ì¸ í–ˆì„ ë•Œ, ìš”ì²­ ê°€ëŠ¥í•œ ë¦¬ì†ŒìŠ¤ë¥¼ ìš”ì²­í–ˆì„ ë•Œ) |
|   403    | ìœ ì € ì¸ì¦ìƒíƒœì™€ ê´€ê³„ ì—†ì´ ì‘ë‹µí•˜ê³  ì‹¶ì§€ ì•Šì€ ë¦¬ì†ŒìŠ¤ë¥¼ í´ë¼ì´ì–¸íŠ¸ê°€ ìš”ì²­í–ˆì„ ë•Œ ì‚¬ìš©í•˜ëŠ” ì‘ë‹µ ì½”ë“œ |
|          | (403 ë³´ë‹¤ëŠ” 400ì´ë‚˜ 404ë¥¼ ì‚¬ìš©í•  ê²ƒì„ ê¶Œê³ . 403 ìì²´ê°€ ë¦¬ì†ŒìŠ¤ê°€ ì¡´ì¬í•œë‹¤ëŠ” ëœ»ì´ê¸° ë•Œë¬¸ì—) |
|   405    | í´ë¼ì´ì–¸íŠ¸ê°€ ìš”ì²­í•œ ë¦¬ì†ŒìŠ¤ì—ì„œëŠ” ì‚¬ìš© ë¶ˆê°€ëŠ¥í•œ Methodë¥¼ ì´ìš©í–ˆì„ ê²½ìš° ì‚¬ìš©í•˜ëŠ” ì‘ë‹µ ì½”ë“œ |

| ìƒíƒœì½”ë“œ |                                                              |
| :------: | :----------------------------------------------------------: |
|   301    | í´ë¼ì´ì–¸íŠ¸ê°€ ìš”ì²­í•œ ë¦¬ì†ŒìŠ¤ì— ëŒ€í•œ URIê°€ ë³€ê²½ ë˜ì—ˆì„ ë•Œ ì‚¬ìš©í•˜ëŠ” ì‘ë‹µ ì½”ë“œ |
|          |  (ì‘ë‹µ ì‹œ Location headerì— ë³€ê²½ëœ URIë¥¼ ì ì–´ ì¤˜ì•¼ í•©ë‹ˆë‹¤.)  |
|   500    |          ì„œë²„ì— ë¬¸ì œê°€ ìˆì„ ê²½ìš° ì‚¬ìš©í•˜ëŠ” ì‘ë‹µ ì½”ë“œ          |





## DTOë€?

> DTO (Data Transfer Object)
> ê³„ì¸µ ê°„ ë°ì´í„° ì „ì†¡ì„ ìœ„í•œ ê°ì²´

- ë¡œì§ì„ ê°–ê³  ìˆì§€ ì•Šì€ ìˆœìˆ˜í•œ ë°ì´í„° ê°ì²´
- Requestìš© DTOì˜ ê²½ìš° @NotEmpty, @Size ë“± ì–´ë…¸í…Œì´ì…˜ì„ ì´ìš©í•´ ì…ë ¥ê°’ì„ ê²€ì¦í•  ìˆ˜ ìˆìŒ
- Response DTOì˜ ê²½ìš° Setter ì‚¬ìš©í•˜ì§€ ì•Šê³ , ìƒì„±ìë¥¼ í†µí•´ ê°’ì„ í• ë‹¹





https://jojoldu.tistory.com/407



https://velog.io/@mooh2jj/%EC%98%AC%EB%B0%94%EB%A5%B8-%EC%97%94%ED%8B%B0%ED%8B%B0-Builder-%EC%82%AC%EC%9A%A9%EB%B2%95

JPA Builder

ì‹œê°„ë‚˜ë©´ ModelMapper >>> MapStructë¡œ ë°”ê¾¸ê¸°

https://mangchhe.github.io/spring/2021/01/25/ModelMapperAndMapStruct/





í† í° >>https://mangkyu.tistory.com/55



ì™œ dtoì— no ë‘ all ì–´ë…¸í…Œì´ì…˜ ë‹¬ì•„ì•¼ ì €ê²Œ ëì„ê¹Œ

---



### Mock

\- **Mock**ì´ë¼ëŠ” ë‹¨ì–´ë¥¼ ì‚¬ì „ì—ì„œ ì°¾ì•„ë³´ë©´ 'í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ ë§Œë“  ëª¨í˜•'ì„ ì˜ë¯¸í•œë‹¤.

\- í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ ì‹¤ì œ ê°ì²´ì™€ ë¹„ìŠ·í•œ ëª¨ì˜ ê°ì²´ë¥¼ ë§Œë“œëŠ” ê²ƒì„ ëª¨í‚¹(Mocking)ì´ë¼ê³  í•˜ë©°, ëª¨í‚¹í•œ ê°ì²´ë¥¼ ë©”ëª¨ë¦¬ì—ì„œ ì–»ì–´ë‚´ëŠ” ê³¼ì •ì„ ëª©ì—…(Mock-up)ì´ë¼ê³  í•œë‹¤.

 

\- ê°ì²´ë¥¼ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•´ì„œëŠ” ë‹¹ì—°íˆ í…ŒìŠ¤íŠ¸ ëŒ€ìƒ ê°ì²´ê°€ ë©”ëª¨ë¦¬ì— ìˆì–´ì•¼ í•œë‹¤.í•˜ì§€ë§Œ ìƒì„±í•˜ëŠ” ë° ë³µì¡í•œ ì ˆì°¨ê°€ í•„ìš”í•˜ê±°ë‚˜ ë§ì€ ì‹œê°„ì´ ì†Œìš”ë˜ëŠ” ê°ì²´ëŠ” ìì£¼ í…ŒìŠ¤íŠ¸í•˜ê¸° ì–´ë µë‹¤. ë˜ëŠ” ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì»¨íŠ¸ë¡¤ëŸ¬ì²˜ëŸ¼ WASë‚˜ ë‹¤ë¥¸ ì†Œí”„íŠ¸ì›¨ì–´ì˜ ë„ì›€ì´ ë°˜ë“œì‹œ í•„ìš”í•œ ê°ì²´ë„ ìˆì„ ìˆ˜ ìˆë‹¤. ì´ëŸ° ë³µì¡í•œ ê°ì²´ëŠ” ë‹¹ì—°íˆ í…ŒìŠ¤íŠ¸ ê³¼ì •ë„ ë³µì¡í•˜ê³  ì–´ë ¤ìš¸ ìˆ˜ ë°–ì— ì—†ë‹¤.

 

\- ë”°ë¼ì„œ í…ŒìŠ¤íŠ¸ í•˜ë ¤ëŠ” ì‹¤ì œ ê°ì²´ì™€ ë¹„ìŠ·í•œ **ê°€ì§œ ê°ì²´**ë¥¼ ë§Œë“¤ì–´ì„œ í…ŒìŠ¤íŠ¸ì— í•„ìš”í•œ ê¸°ëŠ¥ë§Œ ê°€ì§€ë„ë¡ ëª¨í‚¹ì„ í•˜ë©´ í…ŒìŠ¤íŠ¸ê°€ ì‰¬ì›Œì§„ë‹¤.

\- í…ŒìŠ¤íŠ¸í•˜ë ¤ëŠ” ê°ì²´ê°€ ë³µì¡í•œ ì˜ì¡´ì„±ì„ ê°€ì§€ê³  ìˆì„ ë•Œ, ëª¨í‚¹í•œ ê°ì²´ë¥¼ ì´ìš©í•˜ë©´, ì˜ì¡´ì„±ì„ ë‹¨ì ˆì‹œí‚¬ ìˆ˜ ìˆì–´ì„œ ì‰½ê²Œ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆë‹¤.

\- ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ í…ŒìŠ¤íŠ¸í•  ë•Œ, ì„œë¸”ë¦¿ ì»¨í…Œì´ë„ˆë¥¼ ëª¨í‚¹í•˜ê¸° ìœ„í•´ì„œëŠ” **@WebMvcTest**ë¥¼ ì‚¬ìš©í•˜ê±°ë‚˜ **@AutoConfigureMockMvc**ë¥¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤.

 

\- ì›¹ í™˜ê²½ì—ì„œ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ í…ŒìŠ¤íŠ¸í•˜ë ¤ë©´ ë°˜ë“œì‹œ ì„œë¸”ë¦¿ ì»¨í…Œì´ë„ˆê°€ êµ¬ë™ë˜ê³  DispatcherServlet ê°ì²´ê°€ ë©”ëª¨ë¦¬ì— ì˜¬ë¼ê°€ì•¼ í•˜ì§€ë§Œ, ì„œë¸”ë¦¿ ì»¨í…Œì´ë„ˆë¥¼ ëª¨í‚¹í•˜ë©´ ì‹¤ì œ ì„œë¸”ë¦¿ ì»¨í…Œì´ë„ˆê°€ ì•„ë‹Œ í…ŒìŠ¤íŠ¸ìš© ëª¨í˜• ì»¨í…Œì´ë„ˆë¥¼ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— ê°„ë‹¨í•˜ê²Œ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆë‹¤.



---

**@WebMvcTest**

\- @Controller, @RestControllerê°€ ì„¤ì •ëœ í´ë˜ìŠ¤ë“¤ì„ ì°¾ì•„ ë©”ëª¨ë¦¬ì— ìƒì„±í•œë‹¤. 

\- @Serviceë‚˜ @Repositoryê°€ ë¶™ì€ ê°ì²´ë“¤ì€ í…ŒìŠ¤íŠ¸ ëŒ€ìƒì´ ì•„ë‹Œ ê²ƒìœ¼ë¡œ ì²˜ë¦¬ë˜ê¸° ë•Œë¬¸ì— ìƒì„±ë˜ì§€ ì•ŠëŠ”ë‹¤.

\- @WebMvcTestê°€ ì„¤ì •ëœ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ì—ì„œëŠ” ì„œë¸”ë¦¿ ì»¨í…Œì´ë„ˆë¥¼ ëª¨í‚¹í•œ MockMvcíƒ€ì…ì˜ ê°ì²´ë¥¼ ëª©ì—…í•˜ì—¬ ì»¨íŠ¸ë¡¤ëŸ¬ì— ëŒ€í•œ í…ŒìŠ¤íŠ¸ì½”ë“œë¥¼ ì‘ì„±í•  ìˆ˜ ìˆë‹¤.

\- @WebMvcTest ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ë©´ MVC ê´€ë ¨ ì„¤ì •ì¸ @Controller, @ControllerAdvice, @JsonComponentì™€ Filter, WebMvcConfigurer, HandlerMethodArgumentResolverë§Œ ë¡œë“œë˜ê¸° ë•Œë¬¸ì—, ì‹¤ì œ êµ¬ë™ë˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ ë˜‘ê°™ì´ ì»¨í…ìŠ¤íŠ¸ë¥¼ ë¡œë“œí•˜ëŠ” @SpringBootTest ì–´ë…¸í…Œì´ì…˜ë³´ë‹¤ ê°€ë³ê²Œ í…ŒìŠ¤íŠ¸ í•  ìˆ˜ ìˆë‹¤.



#### @AutoConfigureMockMvc ì‚¬ìš©í•˜ê¸° 

\- @AutoConfigureMockMvcëŠ” @WebMvcTestì™€ ë¹„ìŠ·í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì–´ë…¸í…Œì´ì…˜ì´ë‹¤.

\- @SpringBootTestì—ëŠ” ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ í…ŒìŠ¤íŠ¸ë¥¼ ì§€ì›í•˜ëŠ” **webEnvironment** ì†ì„±ì´ ìˆë‹¤. ì´ ì†ì„±ì„ ìƒëµí•˜ë©´ ê¸°ë³¸ê°’ìœ¼ë¡œ WebEnvironment.MOCKì´ ì„¤ì •ë˜ì–´ ìˆëŠ”ë°, ì´ ì„¤ì •ì— ì˜í•´ì„œ ì„œë¸”ë¦¿ ì»¨í…Œì´ë„ˆê°€ ëª¨í‚¹ëœë‹¤.

\- @SpringBootTest(webEnvironment=WebEnvironment.MOCK) ì„¤ì •ìœ¼ë¡œ ëª¨í‚¹í•œ ê°ì²´ë¥¼ ì˜ì¡´ì„± ì£¼ì…ë°›ìœ¼ë ¤ë©´ **@AutoCOnfigureMockMvc**ë¥¼ í´ë˜ìŠ¤ ìœ„ì— ì¶”ê°€ í•´ì•¼í•œë‹¤.



**@AutoConfigureMockMvc**

\- @WebMvcTestì™€ ê°€ì¥ í° ì°¨ì´ì ì€ì€ ì»¨íŠ¸ë¡¤ëŸ¬ë¿ë§Œ ì•„ë‹ˆë¼ í…ŒìŠ¤íŠ¸ ëŒ€ìƒì´ ì•„ë‹Œ **@Service**ë‚˜ **@Repository**ê°€ **ë¶™ì€ ê°ì²´ë“¤ë„ ëª¨ë‘ ë©”ëª¨ë¦¬ì— ì˜¬ë¦°ë‹¤ëŠ” ê²ƒì´ë‹¤.**

\- ê°„ë‹¨í•˜ê²Œ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•´ì„œëŠ” @AutoConfigureMockMvcê°€ ì•„ë‹Œ @WebMvcTestë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤.

\- @WebMvcTestëŠ” @SpringBootTestì™€ ê°™ì´ ì‚¬ìš©ë  ìˆ˜ ì—†ë‹¤. ì™œëƒí•˜ë©´ ê°ì ì„œë¡œì˜ MockMvcë¥¼ ëª¨í‚¹í•˜ê¸° ë•Œë¬¸ì— ì¶©ëŒì´ ë°œìƒí•˜ê¸° ë•Œë¬¸ì´ë‹¤.

 



## @SpringBootTest

@SpringBootTestë¥¼ ì‚¬ìš©í•˜ë©´ ì†ì‰½ê²Œ í†µí•© í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ í™˜ê²½ì„ ì¤€ë¹„í•´ì¤€ë‹¤. @SpringBootTestëŠ” ëª¨ë“  ë¹ˆë“¤ì„ ìŠ¤ìº”í•˜ê³  ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ë¥¼ ìƒì„±í•˜ì—¬ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•œë‹¤. @SpringBootTestì˜ ì–´ë…¸í…Œì´ì…˜ì—ëŠ” ë‹¤ì–‘í•œ ê°’ì„ ì¤„ ìˆ˜ ìˆëŠ”ë°, ì´ë¥¼ ì‚´í´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.

valueì™€ properties: ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰ì— í•„ìš”í•œ í”„ë¡œí¼í‹°ë¥¼ key=value í˜•íƒœë¡œ ì¶”ê°€í•  ìˆ˜ ìˆìŒ
args: ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ argumentsë¡œ ê°’ì„ ì „ë‹¬í•  ìˆ˜ ìˆìŒ
classes: ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë¡œë”©í•  ë•Œ ì‚¬ìš©ë˜ëŠ” ì»´í¬ë„ŒíŠ¸ í´ë˜ìŠ¤ë“¤ì„ ì •ì˜í•  ìˆ˜ ìˆìŒ
webEnvironment: ì›¹ í…ŒìŠ¤íŠ¸ í™˜ê²½ì„ ì„¤ì •í•  ìˆ˜ ìˆìŒ

`@RunWith`ëŠ” JUnitì˜ í…ŒìŠ¤íŠ¸ ëŸ¬ë„ˆë¥¼ í™•ì¥í•˜ëŠ” ë°©ë²• ì¤‘ í•˜ë‚˜ë¡œ ì»¤ìŠ¤í…€ í…ŒìŠ¤íŠ¸ ëŸ¬ë„ˆë¥¼ ì„¤ì •í•´ì£¼ëŠ” ë°©ë²•ì´ë‹¤. í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•  ë•Œ JUnitì— ë‚´ì¥ëœ ì‹¤í–‰ì ì™¸ì— ë‹¤ë¥¸ ì‹¤í–‰ìë¥¼ ì‹¤í–‰ì‹œí‚¨ë‹¤. ìœ„ ì½”ë“œì—ì„œëŠ” **SpringRunner.class**ë¥¼ ì„¤ì •í–ˆê¸° ë•Œë¬¸ì— SpringRunnerë¼ëŠ” ìŠ¤í”„ë§ ì‹¤í–‰ìë¥¼ ì‚¬ìš©í•œë‹¤. ì´ì²˜ëŸ¼ `@RunWith`ëŠ” ìŠ¤í”„ë§ ë¶€íŠ¸ í…ŒìŠ¤íŠ¸ì™€ JUnit ì‚¬ì´ì—ì„œ ì—°ê²°ì ì—­í• ì„ í•œë‹¤.

ğŸ’¡ JUnit5 ë¶€í„°ëŠ” `@RunWith`ì„ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë° ê·¸ ì´ìœ ì— ëŒ€í•´ì„œëŠ” ê¸°ì„ ë‹˜ì´ ì‘ì„±í•˜ì‹  [ìŠ¤í”„ë§ ë¶€íŠ¸, @RunWithê°€ ë” ì´ìƒ ë³´ì´ì§€ ì•ŠëŠ” ì´ìœ ](https://www.whiteship.me/springboot-no-more-runwith/)ë¥¼ ì°¸ê³ í•˜ì.

`@SpringBootTest`ëŠ” `@RunWith`ê³¼ í•¨ê»˜ ì‚¬ìš©í•´ì•¼í•œë‹¤. ì´ ì• ë…¸í…Œì´ì…˜ì—ëŠ” **webEnvironment**ë¼ëŠ” ì†ì„±ì´ ìˆëŠ”ë° ì´ ì†ì„±ì˜ ê¸°ë³¸ ê°’ì€ **MOCK**ìœ¼ë¡œ ë˜ì–´ìˆë‹¤. ì†ì„±ì˜ ê°’ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

- MOCK : mock servlet environment. ë‚´ì¥ í†°ìº£ì„ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ.
- RANDOM_PORT / DEFINED_PORT : ë‚´ì¥ í†°ìº£ì„ ì‚¬ìš©í•¨.
- NONE: ì„œë¸”ë¦¿ í™˜ê²½ì„ ì œê³µí•˜ì§€ ì•ŠìŒ.

ì—¬ê¸°ì„œ ì‚¬ìš©í•˜ëŠ” Mockì— ëŒ€í•´ì„œ ì¡°ê¸ˆ ë” ì•Œì•„ë³´ì.

## Mock íƒ€ì… í…ŒìŠ¤íŠ¸

  Mock íƒ€ì…ì€ Servlet Container(í†°ìº£, jetty ë“±ë“±)ë¥¼ í…ŒìŠ¤íŠ¸ìš©ìœ¼ë¡œ ë„ìš°ì§€ ì•Šê³ , Mockup[1](https://yadon079.github.io/2021/spring boot/boot-test#fn:1)ì„ í•´ì„œ Servletì„ Mocking[2](https://yadon079.github.io/2021/spring boot/boot-test#fn:2)í•œ ê²ƒì„ ë„ì›Œì¤€ë‹¤. dispatcherServletì´ ìƒì„±ì€ ë˜ì§€ë§Œ Mockupì´ ë˜ê¸° ë•Œë¬¸ì—, dispatcherServletì— ìš”ì²­ì„ ë³´ë‚¸ ê²ƒ**â€˜ì²˜ëŸ¼â€™** í…ŒìŠ¤íŠ¸ë¥¼ í•  ìˆ˜ ìˆë‹¤. ì´ ë•Œ mockup ëœ Servletê³¼ ìƒí˜¸ì‘ìš©ì„ í•˜ë ¤ë©´ MockMVCë¼ëŠ” í´ë¼ì´ì–¸íŠ¸ë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤.

MockMVCë¼ëŠ” í´ë¼ì´ì–¸íŠ¸ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ `@AutoConfigureMockMvc` ì• ë…¸í…Œì´ì…˜ì„ ì¶”ê°€í•˜ê³  `@Autowired`ë¥¼ ì‚¬ìš©í•´ì„œ ì£¼ì…ë°›ëŠ” ë°©ë²•ì´ ê°€ì¥ ì‰½ë‹¤. ì´ ì™¸ì—ë„ ì—¬ëŸ¬ê°€ì§€ ë°©ë²•ì´ ìˆëŠ”ë° ìŠ¤í”„ë§ ë¶€íŠ¸ ìµœì‹  ë²„ì „ì—ì„œ MockMVCë¥¼ ë§Œë“œëŠ” ë°©ë²•ì€ ì• ë…¸í…Œì´ì…˜ì„ ì¶”ê°€í•˜ëŠ” ê²ƒì´ ê°€ì¥ ì‰½ë‹¤.

### @Transactional





























---

ê¸°ë³¸ ì…‹íŒ…

```
sudo apt update
sudo apt install openjdk-18-jdk

# ë„ì»¤ ë‹¤ìš´ë¡œë“œ
curl -fsSL https://get.docker.com/|sudo sh
# ë„ì»¤ ê¶Œí•œ ì„¤ì •, ì»¨í…Œì´ë„ˆ ë‘ê°œ ì´ìƒì¼ê²½ìš° ì—°ê²°ì‹œí‚¤ê³  ìœ ê¸°ì ìœ¼ë¡œ í™œìš©í• ë ¤ë©´ í•„ìš”í•¨ compose ì‚¬ìš©í•˜ê¸°ë•Œë¬¸ì—
sudo usermod -aG docker $USER

#docker-django ë””ë ‰í† ë¦¬ì—ì„œ docker compose ë‹¤ìš´ë¡œë“œ
sudo curl -L "https://github.com/docker/compose/releases/download/1.29.2/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
```







Dockerfile

```
FROM openjdk:18-jdk-alpine
ARG JAR_FILE=./*.jar
COPY ${JAR_FILE} app.jar
ENTRYPOINT ["java","-jar","/app.jar"]
```

docker-compose.yml

```
version: '3'
services:
  spring-app:
      container_name: spring-app
      image: docker/spring
      ports:
       - "8080:8080"
  nginx:
      container_name: nginx
      image: docker/nginx
      ports:
       - "80:80"
      depends_on:
       - spring-app
```

Nginx/Dockerfile

```
FROM nginx:latest
RUN rm -rf /etc/nginx/conf.d/default.conf

COPY nginx-app.conf  /etc/nginx/conf.d/app.conf
COPY nginx.conf  /etc/nginx/nginx.conf

VOLUME ["/data", "/etc/nginx", "/var/log/nginx"]

WORKDIR /etc/nginx

CMD ["nginx"]
```

nginx-app.conf

```
server {
    listen       80;
    listen      [::]:80;

    server_name  "";

    access_log off;

    location / {
            proxy_pass http://[ec2 ip]:8080;
    	    proxy_set_header Host $host:$server_port;
            proxy_set_header X-Forwarded-Host $server_name;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        }

}
```

nginx.conf

```
daemon off;
user  www-data;
worker_processes  2;

error_log  /var/log/nginx/error.log warn;
pid        /var/run/nginx.pid;

events {
    worker_connections  1024;
    use epoll;
    accept_mutex off;
}

http {
    include       /etc/nginx/mime.types;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;

    default_type  application/octet-stream;

    log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '
                      '$status $body_bytes_sent "$http_referer" '
                      '"$http_user_agent" "$http_x_forwarded_for"';

    access_log  /var/log/nginx/access.log  main;

    sendfile        on;
    #tcp_nopush     on;

    keepalive_timeout  65;

    client_max_body_size 300m;
    client_body_buffer_size 128k;

    gzip  on;
    gzip_http_version 1.0;
    gzip_comp_level 6;
    gzip_min_length 0;
    gzip_buffers 16 8k;
    gzip_proxied any;
    gzip_types text/plain text/css text/xml text/javascript application/xml application/xml+rss application/javascript application/json;
    gzip_disable "MSIE [1-6]\.";
    gzip_vary on;

    include /etc/nginx/conf.d/*.conf;
}
```



### Object Mapper

https://velog.io/@zooneon/Java-ObjectMapper%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%98%EC%97%AC-JSON-%ED%8C%8C%EC%8B%B1%ED%95%98%EA%B8%B0





### postgre ëª¨ë“  í…Œì´ë¸” ì‚­ì œí•˜ê¸°

```
DROP SCHEMA public CASCADE;
 CREATE SCHEMA public;
GRANT ALL ON SCHEMA public TO postgres;
 GRANT ALL ON SCHEMA public TO public;
```





#### JSON

https://umanking.github.io/2021/07/24/jackson-localdatetime-serialization/





### Mock TEST

https://ktko.tistory.com/entry/%EC%8A%A4%ED%94%84%EB%A7%81Spring-MockMvc-%ED%85%8C%EC%8A%A4%ED%8A%B8

https://bomz.tistory.com/29

https://itmore.tistory.com/entry/MockMvc-%EC%83%81%EC%84%B8%EC%84%A4%EB%AA%85

https://velog.io/@geesuee/Spring-Spring-Boot-MockMvc

https://yadon079.github.io/2021/spring%20boot/boot-test

https://elevatingcodingclub.tistory.com/61

https://we1cometomeanings.tistory.com/65

https://mangkyu.tistory.com/144





## Jenkins ì„¤ì¹˜

```
sudo apt update
sudo apt install openjdk-18-jdk

curl -fsSL https://pkg.jenkins.io/debian-stable/jenkins.io.key | sudo tee \
    /usr/share/keyrings/jenkins-keyring.asc > /dev/null
    
echo deb [signed-by=/usr/share/keyrings/jenkins-keyring.asc] \
    https://pkg.jenkins.io/debian-stable binary/ | sudo tee \
    /etc/apt/sources.list.d/jenkins.list > /dev/null
    
sudo apt-get update
sudo apt-get install fontconfig openjdk-11-jre
sudo apt-get install jenkins
```

https://gksdudrb922.tistory.com/195

https://abbo.tistory.com/184

### Junkins ì‹¤í–‰

```
sudo vi /usr/lib/systemd/system/jenkins.service
```



```
sudo systemctl daemon-reload
sudo systemctl start jenkins
sudo systemctl status jenkins
```

--ì‹œì‘

sudo service jenkins start

 

--ì¢…ë£Œ

sudo service jenkins stop

 

--restart

sudo service jenkins restart



